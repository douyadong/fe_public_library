+function(){function e(a,l,t,n,i){if(0!==l){if(a&&a.length>0)for(var c=0;c<a.length;c++)a[c]&&a[c][i.itemsMapping]&&e(a[c][i.itemsMapping],l-1,t,n,i)}else if(a)for(var c=0;c<a.length;c++)a[c][i.itemMapping.id]==t&&n.push(a[c])}var a={itemsMapping:"items",itemMapping:{id:"id",text:"text"},minimumInput:1,dynamic:!1,placeholder:{id:"",text:"--请选择--"}};$.cascadingSelect2=function(l){l=Object.assign({},a,l),console.log(l),l.data?$.each(l.selects,function(a,t){$(t.ele).select2({data:0===a&&l.data||null,language:"zh-CN",placeholder:t.placeholder&&t.placeholder.text||l.placeholder.text}).on("change",function(){var n=$(t.ele).val(),i=[];e(l.data,a,n,i,l),i.length>0&&(i=i[0][l.itemsMapping]);var c=l.selects[a+1];if(c){$(c.ele).select2("val",""),$(c.ele).find("option").remove(),$(c.ele).select2({data:i,language:"zh-CN",placeholder:c.placeholer&&c.placeholder.text||l.placeholder.text});for(var r=a+2;r<l.selects.length;r++)$(l.selects[r].ele).select2("val",""),$(l.selects[r].ele).find("option").remove()}})}):$.each(l.selects,function(e,a){var t=$(a.ele).data("value");void 0!==t&&(a.initial=t);var n={};l.dynamic?(n={minimumInputLength:a.minimumInput||l.minimumInput,ajax:{url:function(){var t=a.url,n=l.selects[e-1];return e>0&&(void 0===n.value||null===n.value||""===n.value?t=a.url:t+="?"+l.selects[e-1].paramNameForNext+"="+l.selects[e-1].value),t},dataType:a.dataType||"json",delay:a.delay||250,data:a.data&&"function"==typeof a.data&&a.data||function(e){var l=$.extend({},a.data);return l[a.paramName]=e.term,l},processResults:a.processResults||function(e,a){return a.page=a.page||1,{results:e[l.itemsMapping],pagination:{more:!1}}},transport:function(l,t,n){if(e>0&&a.url===l.url)return null;var i=$.ajax(l);return i.then(t),i.fail(n),i}},language:"zh-CN",placeholder:a.placeholder&&a.placeholder.text||l.placeholder.text},$(a.ele).select2(n)):0==e?$.ajax({url:a.url,data:a.data,success:function(e){e=a.processResults&&a.processResults(e)||e;var t=$(a.ele);console.log(a.initial),$.each(e,function(e,n){var i=n[l.itemMapping.id];t.append("<option value='"+i+"' "+(a.initial==i?"selected":"")+">"+n[l.itemMapping.text]+"</option>")}),$(a.ele).select2({language:"zh-CN"}),delete a.initial,a.ready&&a.ready()}}):$(a.ele).select2({language:"zh-CN",placeholder:a.placeholder&&a.placeholder.text||l.placeholder.text}),$(a.ele).on("change",function(){var t=$(a.ele).val(),n=a.placeholder&&a.placeholder.id;a.value=t;for(var i=e+1;i<l.selects.length;i++)l.selects[i].value=null,$(l.selects[i].ele).find("option").remove(),$(l.selects[i].ele).select2({language:"zh-CN",placeholder:a.placeholder});if(!l.dynamic){var c=l.selects[e+1];if(c&&t!=n){var r=c.url;void 0===a.value||null===a.value||""===a.value?r=c.url:r+="?"+a.paramNameForNext+"="+a.value,$.ajax({url:r,data:"function"==typeof c.data&&c.data()||c.data||{},success:function(e){e=c.processResults&&c.processResults(e)||e;var a=$(c.ele);$.each(e,function(e,t){var n=t[l.itemMapping.id];a.append("<option value='"+n+"' "+(c.initial==n?"selected":"")+">"+t[l.itemMapping.text]+"</option>")}),a.select2({language:"zh-CN"}),delete c.initial,c.ready&&c.ready()}})}}null!=a.value&&""!=a.value&&"-1"!=a.value&&a.selected&&a.selected()})})}}(jQuery);