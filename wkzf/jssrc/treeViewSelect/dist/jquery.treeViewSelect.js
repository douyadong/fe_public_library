!function(e,t,s,i){"use strict";var n="treeview",o={};o.settings={injectStyle:!0,levels:2,expandIcon:"glyphicon glyphicon-plus",collapseIcon:"glyphicon glyphicon-minus",emptyIcon:"glyphicon",nodeIcon:"",selectedIcon:"",checkedIcon:"glyphicon glyphicon-check",uncheckedIcon:"glyphicon glyphicon-unchecked",color:i,backColor:i,borderColor:i,onhoverColor:"#F5F5F5",selectedColor:"#FFFFFF",selectedBackColor:"#428bca",searchResultColor:"#D9534F",searchResultBackColor:i,enableUpCascade:!0,enableDownCascade:!0,enableLinks:!1,highlightSelected:!0,highlightSearchResults:!0,showBorder:!0,showIcon:!0,showSearch:!1,showCheckbox:!1,showTags:!1,multiSelect:!1,onNodeChecked:i,onNodeCollapsed:i,onNodeDisabled:i,onNodeEnabled:i,onNodeExpanded:i,onNodeSelected:i,onNodeUnchecked:i,onNodeUnselected:i,onSearchComplete:i,onSearchCleared:i},o.options={silent:!1,ignoreChildren:!1},o.searchOptions={ignoreCase:!0,exactMatch:!1,revealResults:!0};var r=function(t,s){return this.$element=e(t),this.elementId=t.id,this.styleId=this.elementId+"-style",this.init(s),{options:this.options,init:e.proxy(this.init,this),remove:e.proxy(this.remove,this),getNode:e.proxy(this.getNode,this),getAllNodes:e.proxy(this.getAllNodes,this),getParent:e.proxy(this.getParent,this),getParents:e.proxy(this.getParents,this),getSiblings:e.proxy(this.getSiblings,this),getSelected:e.proxy(this.getSelected,this),getUnselected:e.proxy(this.getUnselected,this),getExpanded:e.proxy(this.getExpanded,this),getCollapsed:e.proxy(this.getCollapsed,this),getChecked:e.proxy(this.getChecked,this),getUnchecked:e.proxy(this.getUnchecked,this),getDisabled:e.proxy(this.getDisabled,this),getEnabled:e.proxy(this.getEnabled,this),selectNode:e.proxy(this.selectNode,this),unselectNode:e.proxy(this.unselectNode,this),toggleNodeSelected:e.proxy(this.toggleNodeSelected,this),collapseAll:e.proxy(this.collapseAll,this),collapseNode:e.proxy(this.collapseNode,this),expandAll:e.proxy(this.expandAll,this),expandNode:e.proxy(this.expandNode,this),toggleNodeExpanded:e.proxy(this.toggleNodeExpanded,this),revealNode:e.proxy(this.revealNode,this),checkAll:e.proxy(this.checkAll,this),checkNode:e.proxy(this.checkNode,this),uncheckAll:e.proxy(this.uncheckAll,this),uncheckNode:e.proxy(this.uncheckNode,this),toggleNodeChecked:e.proxy(this.toggleNodeChecked,this),disableAll:e.proxy(this.disableAll,this),disableNode:e.proxy(this.disableNode,this),enableAll:e.proxy(this.enableAll,this),enableNode:e.proxy(this.enableNode,this),toggleNodeDisabled:e.proxy(this.toggleNodeDisabled,this),search:e.proxy(this.search,this),clearSearch:e.proxy(this.clearSearch,this)}};r.prototype.init=function(t){this.tree=[],this.nodes=[],this.childsNodes=[],this.parentNodes=[],t.data&&("string"==typeof t.data&&(t.data=e.parseJSON(t.data)),this.tree=e.extend(!0,[],t.data),delete t.data),this.options=e.extend({},o.settings,t),this.destroy(),this.subscribeEvents(),this.setInitialStates({nodes:this.tree},0),this.render()},r.prototype.remove=function(){this.destroy(),e.removeData(this,n),e("#"+this.styleId).remove()},r.prototype.destroy=function(){this.initialized&&(this.$wrapper.remove(),this.$wrapper=null,this.unsubscribeEvents(),this.initialized=!1)},r.prototype.unsubscribeEvents=function(){this.$element.off("click"),this.$element.off("nodeChecked"),this.$element.off("nodeCollapsed"),this.$element.off("nodeDisabled"),this.$element.off("nodeEnabled"),this.$element.off("nodeExpanded"),this.$element.off("nodeSelected"),this.$element.off("nodeUnchecked"),this.$element.off("nodeUnselected"),this.$element.off("searchComplete"),this.$element.off("searchCleared")},r.prototype.subscribeEvents=function(){this.unsubscribeEvents(),this.$element.on("click",e.proxy(this.clickHandler,this)),"function"==typeof this.options.onNodeChecked&&this.$element.on("nodeChecked",this.options.onNodeChecked),"function"==typeof this.options.onNodeCollapsed&&this.$element.on("nodeCollapsed",this.options.onNodeCollapsed),"function"==typeof this.options.onNodeDisabled&&this.$element.on("nodeDisabled",this.options.onNodeDisabled),"function"==typeof this.options.onNodeEnabled&&this.$element.on("nodeEnabled",this.options.onNodeEnabled),"function"==typeof this.options.onNodeExpanded&&this.$element.on("nodeExpanded",this.options.onNodeExpanded),"function"==typeof this.options.onNodeSelected&&this.$element.on("nodeSelected",this.options.onNodeSelected),"function"==typeof this.options.onNodeUnchecked&&this.$element.on("nodeUnchecked",this.options.onNodeUnchecked),"function"==typeof this.options.onNodeUnselected&&this.$element.on("nodeUnselected",this.options.onNodeUnselected),"function"==typeof this.options.onSearchComplete&&this.$element.on("searchComplete",this.options.onSearchComplete),"function"==typeof this.options.onSearchCleared&&this.$element.on("searchCleared",this.options.onSearchCleared)},r.prototype.setInitialStates=function(t,s){if(t.nodes){s+=1;var i=t,n=this;e.each(t.nodes,function(e,t){t.nodeId=n.nodes.length,t.parentId=i.nodeId,t.hasOwnProperty("selectable")||(t.selectable=!0),t.state=t.state||{},t.state.hasOwnProperty("checked")||(t.state.checked=!1),t.state.hasOwnProperty("disabled")||(t.state.disabled=!1),t.state.hasOwnProperty("expanded")||(!t.state.disabled&&s<n.options.levels&&t.nodes&&t.nodes.length>0?t.state.expanded=!0:t.state.expanded=!1),t.state.hasOwnProperty("selected")||(t.state.selected=!1),n.nodes.push(t),t.nodes&&n.setInitialStates(t,s)})}},r.prototype.clickHandler=function(t){this.options.enableLinks||t.preventDefault();var s=e(t.target),i=this.findNode(s);if(i){var n=s.attr("class")?s.attr("class").split(" "):[];if(n.indexOf("expand-icon")!==-1)this.toggleExpandedState(i,o.options),this.render();else if(n.indexOf("check-icon")!==-1){if(i.state.disabled)return;this.toggleCheckedState(i,o.options),this.render()}else i.selectable?this.toggleSelectedState(i,o.options):this.toggleExpandedState(i,o.options),this.render()}},r.prototype.findNode=function(e){var t=e.closest("li.list-group-item").attr("data-nodeid"),s=this.nodes[t];return s||console.log("Error: node does not exist"),s},r.prototype.toggleExpandedState=function(e,t){e&&this.setExpandedState(e,!e.state.expanded,t)},r.prototype.setExpandedState=function(t,s,i){s!==t.state.expanded&&(s&&t.nodes?(t.state.expanded=!0,i.silent||this.$element.trigger("nodeExpanded",e.extend(!0,{},t))):s||(t.state.expanded=!1,i.silent||this.$element.trigger("nodeCollapsed",e.extend(!0,{},t)),t.nodes&&!i.ignoreChildren&&e.each(t.nodes,e.proxy(function(e,t){this.setExpandedState(t,!1,i)},this))))},r.prototype.toggleSelectedState=function(e,t){e&&this.setSelectedState(e,!e.state.selected,t)},r.prototype.setSelectedState=function(t,s,i){s!==t.state.selected&&(s?(this.options.multiSelect||e.each(this.findNodes("true","g","state.selected"),e.proxy(function(e,t){this.setSelectedState(t,!1,i)},this)),t.state.selected=!0,i.silent||this.$element.trigger("nodeSelected",e.extend(!0,{},t))):(t.state.selected=!1,i.silent||this.$element.trigger("nodeUnselected",e.extend(!0,{},t))))},r.prototype.toggleCheckedState=function(e,t){e&&this.setCheckedState(e,!e.state.checked,t)},r.prototype.setCheckedState=function(t,s,i){var n,o,r=this;s!==t.state.checked&&(n=!!s,o=s?"nodeChecked":"nodeUnchecked",t.state.checked=n,(r.options.enableUpCascade||r.options.enableDownCascade)&&(r.childsNodes=[],r.parentNodes=[],r.options.enableDownCascade&&(r.getChilds(t),r.childsNodes&&r.childsNodes.length&&e.each(r.childsNodes,function(e,t){t.state.checked=n})),r.options.enableUpCascade&&(r.getParents(t),e.each(r.parentNodes,function(e,t){var s=r.getChecked(t);s.length==t.nodes.length&&(t.state.checked=!0)}))),i.silent||r.$element.trigger(o,e.extend(!0,{},t)))},r.prototype.setDisabledState=function(t,s,i){s!==t.state.disabled&&(s?(t.state.disabled=!0,this.setExpandedState(t,!1,i),this.setSelectedState(t,!1,i),this.setCheckedState(t,!1,i),i.silent||this.$element.trigger("nodeDisabled",e.extend(!0,{},t))):(t.state.disabled=!1,i.silent||this.$element.trigger("nodeEnabled",e.extend(!0,{},t))))},r.prototype.render=function(){this.initialized||(this.$element.addClass(n),this.$wrapper=e(this.template.list),this.injectStyle(),this.initialized=!0),this.$element.empty().append(this.$wrapper.empty()),this.buildTree(this.tree,0)},r.prototype.buildTree=function(t,s){if(t){s+=1;var i=this;e.each(t,function(t,n){for(var o=e(i.template.item).addClass("node-"+i.elementId).addClass(n.state.checked?"node-checked":"").addClass(n.state.disabled?"node-disabled":"").addClass(n.state.selected?"node-selected":"").addClass(n.searchResult?"search-result":"").attr("data-nodeid",n.nodeId).attr("style",i.buildStyleOverride(n)),r=0;r<s-1;r++)o.append(i.template.indent);var a=[];if(n.nodes?(a.push("expand-icon"),n.state.expanded?a.push(i.options.collapseIcon):a.push(i.options.expandIcon)):a.push(i.options.emptyIcon),o.append(e(i.template.icon).addClass(a.join(" "))),i.options.showIcon){var a=["node-icon"];a.push(n.icon||i.options.nodeIcon),n.state.selected&&(a.pop(),a.push(n.selectedIcon||i.options.selectedIcon||n.icon||i.options.nodeIcon)),o.append(e(i.template.icon).addClass(a.join(" ")))}if(i.options.showCheckbox){var a=["check-icon"];n.state.checked?a.push(i.options.checkedIcon):a.push(i.options.uncheckedIcon),o.append(e(i.template.icon).addClass(a.join(" ")))}if(i.options.enableLinks?o.append(e(i.template.link).attr("href",n.href).append(n.text)):o.append(n.text),i.options.showTags&&n.tags&&e.each(n.tags,function(t,s){o.append(e(i.template.badge).append(s))}),i.$wrapper.append(o),n.nodes&&n.state.expanded)return i.buildTree(n.nodes,s)})}},r.prototype.buildStyleOverride=function(e){var t=e.color,s=e.backColor;return this.options.highlightSelected&&e.state.selected&&(this.options.selectedColor&&(t=this.options.selectedColor),this.options.selectedBackColor&&(s=this.options.selectedBackColor)),this.options.highlightSearchResults&&e.searchResult&&(this.options.searchResultColor&&(t=this.options.searchResultColor),this.options.searchResultBackColor&&(s=this.options.searchResultBackColor)),"color:"+t+";background-color:"+s+";"},r.prototype.injectStyle=function(){this.options.injectStyle&&!s.getElementById(this.styleId)&&e('<style type="text/css" id="'+this.styleId+'"> '+this.buildStyle()+" </style>").appendTo("head")},r.prototype.buildStyle=function(){var e=".node-"+this.elementId+"{";return this.options.color&&(e+="color:"+this.options.color+";"),this.options.backColor&&(e+="background-color:"+this.options.backColor+";"),this.options.showBorder?this.options.borderColor&&(e+="border:1px solid "+this.options.borderColor+";"):e+="border:none;",e+="}",e+=this.options.onhoverColor?".node-"+this.elementId+":not(.node-disabled):hover{background-color:"+this.options.onhoverColor+";}":".node-"+this.elementId+"{cursor:default !important}",this.css+e},r.prototype.template={list:'<ul class="list-group"></ul>',item:'<li class="list-group-item"></li>',indent:'<span class="indent"></span>',icon:'<span class="icon"></span>',link:'<a href="#" style="color:inherit;"></a>',badge:'<span class="badge"></span>'},r.prototype.css=".treeview .list-group-item{cursor:pointer}.treeview span.indent{margin-left:10px;margin-right:10px}.treeview span.icon{width:12px;margin-right:5px}.treeview .node-disabled{color:silver;cursor:not-allowed}",r.prototype.getNode=function(e){return this.nodes[e]},r.prototype.getAllNodes=function(e){return this.nodes},r.prototype.getParent=function(e){var t=this.identifyNode(e);return this.nodes[t.parentId]},r.prototype.getParents=function(e){var t=this.getParent(e);t&&(this.parentNodes.push(t),this.getParents(t))},r.prototype.getChilds=function(t){var s=this,i=this.identifyNode(t);i.nodes&&e.each(i.nodes,function(e,t){s.childsNodes.push(t),s.getChilds(t)})},r.prototype.getSiblings=function(e){var t=this.identifyNode(e),s=this.getParent(t),i=s?s.nodes:this.tree;return i.filter(function(e){return e.nodeId!==t.nodeId})},r.prototype.getSelected=function(){return this.findNodes("true","g","state.selected")},r.prototype.getUnselected=function(){return this.findNodes("false","g","state.selected")},r.prototype.getExpanded=function(){return this.findNodes("true","g","state.expanded")},r.prototype.getCollapsed=function(){return this.findNodes("false","g","state.expanded")},r.prototype.getChecked=function(e){return e&&e.nodes?e.nodes.filter(function(e){return e.state.checked}):this.findNodes("true","g","state.checked")},r.prototype.getUnchecked=function(){return this.findNodes("false","g","state.checked")},r.prototype.getDisabled=function(){return this.findNodes("true","g","state.disabled")},r.prototype.getEnabled=function(){return this.findNodes("false","g","state.disabled")},r.prototype.selectNode=function(t,s){this.forEachIdentifier(t,s,e.proxy(function(e,t){this.setSelectedState(e,!0,t)},this)),this.render()},r.prototype.unselectNode=function(t,s){this.forEachIdentifier(t,s,e.proxy(function(e,t){this.setSelectedState(e,!1,t)},this)),this.render()},r.prototype.toggleNodeSelected=function(t,s){this.forEachIdentifier(t,s,e.proxy(function(e,t){this.toggleSelectedState(e,t)},this)),this.render()},r.prototype.collapseAll=function(t){var s=this.findNodes("true","g","state.expanded");this.forEachIdentifier(s,t,e.proxy(function(e,t){this.setExpandedState(e,!1,t)},this)),this.render()},r.prototype.collapseNode=function(t,s){this.forEachIdentifier(t,s,e.proxy(function(e,t){this.setExpandedState(e,!1,t)},this)),this.render()},r.prototype.expandAll=function(t){if(t=e.extend({},o.options,t),t&&t.levels)this.expandLevels(this.tree,t.levels,t);else{var s=this.findNodes("false","g","state.expanded");this.forEachIdentifier(s,t,e.proxy(function(e,t){this.setExpandedState(e,!0,t)},this))}this.render()},r.prototype.expandNode=function(t,s){this.forEachIdentifier(t,s,e.proxy(function(e,t){this.setExpandedState(e,!0,t),e.nodes&&t&&t.levels&&this.expandLevels(e.nodes,t.levels-1,t)},this)),this.render()},r.prototype.expandLevels=function(t,s,i){i=e.extend({},o.options,i),e.each(t,e.proxy(function(e,t){this.setExpandedState(t,s>0,i),t.nodes&&this.expandLevels(t.nodes,s-1,i)},this))},r.prototype.revealNode=function(t,s){this.forEachIdentifier(t,s,e.proxy(function(e,t){for(var s=this.getParent(e);s;)this.setExpandedState(s,!0,t),s=this.getParent(s)},this)),this.render()},r.prototype.toggleNodeExpanded=function(t,s){this.forEachIdentifier(t,s,e.proxy(function(e,t){this.toggleExpandedState(e,t)},this)),this.render()},r.prototype.checkAll=function(t){var s=this.findNodes("false","g","state.checked");this.forEachIdentifier(s,t,e.proxy(function(e,t){this.setCheckedState(e,!0,t)},this)),this.render()},r.prototype.checkNode=function(t,s){this.forEachIdentifier(t,s,e.proxy(function(e,t){this.setCheckedState(e,!0,t)},this)),this.render()},r.prototype.uncheckAll=function(t){var s=this.findNodes("true","g","state.checked");this.forEachIdentifier(s,t,e.proxy(function(e,t){this.setCheckedState(e,!1,t)},this)),this.render()},r.prototype.uncheckNode=function(t,s){this.forEachIdentifier(t,s,e.proxy(function(e,t){this.setCheckedState(e,!1,t)},this)),this.render()},r.prototype.toggleNodeChecked=function(t,s){this.forEachIdentifier(t,s,e.proxy(function(e,t){this.toggleCheckedState(e,t)},this)),this.render()},r.prototype.disableAll=function(t){var s=this.findNodes("false","g","state.disabled");this.forEachIdentifier(s,t,e.proxy(function(e,t){this.setDisabledState(e,!0,t)},this)),this.render()},r.prototype.disableNode=function(t,s){this.forEachIdentifier(t,s,e.proxy(function(e,t){this.setDisabledState(e,!0,t)},this)),this.render()},r.prototype.enableAll=function(t){var s=this.findNodes("true","g","state.disabled");this.forEachIdentifier(s,t,e.proxy(function(e,t){this.setDisabledState(e,!1,t)},this)),this.render()},r.prototype.enableNode=function(t,s){this.forEachIdentifier(t,s,e.proxy(function(e,t){this.setDisabledState(e,!1,t)},this)),this.render()},r.prototype.toggleNodeDisabled=function(t,s){this.forEachIdentifier(t,s,e.proxy(function(e,t){this.setDisabledState(e,!e.state.disabled,t)},this)),this.render()},r.prototype.forEachIdentifier=function(t,s,i){s=e.extend({},o.options,s),t instanceof Array||(t=[t]),e.each(t,e.proxy(function(e,t){i(this.identifyNode(t),s)},this))},r.prototype.identifyNode=function(e){return"number"==typeof e?this.nodes[e]:e},r.prototype.search=function(t,s){s=e.extend({},o.searchOptions,s),this.clearSearch({render:!1});var i=[];if(t&&t.length>0){s.exactMatch&&(t="^"+t+"$");var n="g";s.ignoreCase&&(n+="i"),i=this.findNodes(t,n),e.each(i,function(e,t){t.searchResult=!0})}return s.revealResults?this.revealNode(i):this.render(),this.$element.trigger("searchComplete",e.extend(!0,{},i)),i},r.prototype.clearSearch=function(t){t=e.extend({},{render:!0},t);var s=e.each(this.findNodes("true","g","searchResult"),function(e,t){t.searchResult=!1});t.render&&this.render(),this.$element.trigger("searchCleared",e.extend(!0,{},s))},r.prototype.findNodes=function(t,s,i){s=s||"g",i=i||"text";var n=this;return e.grep(this.nodes,function(e){var o=n.getNodeValue(e,i);if("string"==typeof o)return o.match(new RegExp(t,s))})},r.prototype.getNodeValue=function(e,t){var s=t.indexOf(".");if(s>0){var n=e[t.substring(0,s)],o=t.substring(s+1,t.length);return this.getNodeValue(n,o)}return e.hasOwnProperty(t)?e[t].toString():i};var a=function(e){t.console&&t.console.error(e)};e.fn[n]=function(t,s){var i;return this.each(function(){var o=e.data(this,n);"string"==typeof t?o?e.isFunction(o[t])&&"_"!==t.charAt(0)?(s instanceof Array||(s=[s]),i=o[t].apply(o,s)):a("No such method : "+t):a("Not initialized, can not call method : "+t):"boolean"==typeof t?i=o:e.data(this,n,new r(this,e.extend(!0,{},t)))}),i||this}}(jQuery,window,document),function(e,t,s,i){function n(s){function i(e,t){var s=t.pid,i=e.map;if(i[t.id]=t,t.open&&(t.state={expanded:!0}),null===s||0===s)e.res.push(t);else{var n=i[s];n?n.hasOwnProperty("nodes")?n.nodes.push(t):n.nodes=[t]:e.res.push(t)}return e}var n=t.JSON.stringify(s);return n=n.replace(/name/g,"text"),s=e.parseJSON(n),s.reduce(i,{res:[],map:{}}).res}function o(e,t,s){var n=e.treeview("getParent",t);return n!=i&&n.id?(s.push(n),void o(e,n,s)):s}function r(e,t){var s,i,n,r=new Array;if(1==t.length&&0==t[0].nodeId)r.push(t[0]);else for(var a=0;a<t.length;a++){s=t[a],i=new Array,n=new Array,o(e,s,i);for(var l=0;l<i.length;l++)i[l].state.checked&&n.push(i[l]);n.length>0?(s=n.sortNode()[0],r.containsNode(s)||r.push(s)):r.containsNode(s)||r.push(s)}return r}function a(t,s){return this.element=e(t),this.defaults=d,this.name=l,this.init(s),{settings:this.settings,init:e.proxy(this.init,this),getChecked:e.proxy(this.getChecked,this),setDefaults:e.proxy(this.setDefaults,this)}}var l="treeViewSelect",d={apiUrl:"",type:"GET",dataType:"jsonp",timeout:3e3,data:null,showSearch:!0,placeholder:"请选择...",defaultVals:null,enableUpCascade:!0,enableDownCascade:!0,cascadeText:!1,cascadeTextSeparator:"-",successCallback:null,errorCallback:null,exceptionCallback:null,onCompleted:i,bootstrapTreeParams:{levels:2,multiSelect:!0,checkedIcon:"glyphicon glyphicon-stop",showBorder:!1}};Array.prototype.containsNode=function(e){for(var t=0;t<this.length;t++)if(this[t].nodeId===e.nodeId)return!0;return!1},Array.prototype.sortNode=function(){for(var e,t=this,s=0;s<t.length;s++)for(var i=0;i<t.length-s-1;i++)t[i].nodeId>t[i+1].nodeId&&(e=t[i],t[i]=t[i+1],t[i+1]=e);return t},a.prototype.init=function(t){this.settings?this.settings=e.extend({},this.settings,t):this.settings=e.extend(!0,this.defaults,t),this.treeContainer=e(this.template.treeContainer),this.tree=e(this.template.tree),this.searchInput=e(this.template.searchInput),this.placeholder=e(this.template.placeholder).html(this.settings.placeholder),this.defaultVals=this.element.attr("data-id")?this.element.attr("data-id").split(","):[],this.destroy(),this.subscribeEvents(),this.setInitialStates()},a.prototype.destroy=function(){this.element.off("click"),e("html").off("click"),this.searchInput.off("keyup"),this.element.empty(),this.treeContainer.empty(),this.initialized=!1},a.prototype.subscribeEvents=function(){this.unsubscribeEvents(),"function"==typeof this.settings.onCompleted&&this.element.on("completed",this.settings.onCompleted)},a.prototype.unsubscribeEvents=function(){this.element.off("nodeChecked"),this.element.off("nodeUnchecked"),this.element.off("nodeSelected"),this.element.off("nodeUnselected"),this.element.off("nodesCleared"),this.element.off("completed")},a.prototype.setInitialStates=function(){var t=this;if(t.element.attr("data-tree"))t.treeData=e.parseJSON(t.element.attr("data-tree")),t.buildTreeSelect();else try{e.ajax({url:t.settings.apiUrl,type:t.settings.type,timeout:t.settings.timeout,dataType:t.settings.dataType,data:t.settings.data,success:function(s){s&&"1"==s.status?s.data&&(t.initialized=!0,"string"==typeof s.data?t.treeData=e.parseJSON(s.data):t.treeData=s.data,t.buildTreeSelect(),t.settings.successCallback&&successCallback()):t.settings.exceptionCallback&&t.settings.exceptionCallback()},error:function(e){t.settings.errorCallback&&t.settings.errorCallback()}})}catch(s){h(s),t.settings.errorCallback&&t.settings.errorCallback()}},a.prototype.buildTreeSelect=function(){var t;this.element.addClass("treeviewSelect-selection"),this.element.append(e(this.placeholder)),this.element.append(e(this.template.listGroup)),this.element.append(e(this.template.listOpGroup)),t="treeContainerId_"+parseInt(e(".treeviewSelect-container").length+1),this.treeContainer.attr("id",t),this.settings.showSearch&&this.treeContainer.append(this.searchInput),this.treeContainer.append(this.tree),this.element.parent().append(this.treeContainer),this.setTree(),this.setSelectList(),this.renderItems(!0)},a.prototype.setTree=function(){var e=this.settings.bootstrapTreeParams;e.data=n(this.treeData),e.showCheckbox=this.settings.bootstrapTreeParams.multiSelect,e.highlightSelected=!this.settings.bootstrapTreeParams.multiSelect,e.onhoverColor=this.settings.bootstrapTreeParams.multiSelect?"":"#F5F5F5",e.enableUpCascade=this.settings.enableUpCascade,e.enableDownCascade=this.settings.enableDownCascade,this.tree.treeview(e),this.bindTreeEvents(),this.setTreePosition()},a.prototype.bindTreeEvents=function(){var t=this;t.searchInput.keyup(function(s){var i=e(this),n=t.searchNodes(e.trim(i.val()));if(n&&n.length>0){var o=t.tree.find("li[data-nodeid="+n[0].nodeId+"]");o.length>0?t.tree.scrollTop(o.position().top-60):t.tree.scrollTop(0)}}),t.settings.bootstrapTreeParams.multiSelect?t.tree.on("nodeChecked nodeUnchecked",function(e,s){t.renderItems()}):t.tree.on("nodeSelected",function(e,s){t.treeContainer.addClass("hide"),t.renderItems()})},a.prototype.setSelectList=function(){var t=this;t.element.on("click",function(){var s;return e(".treeviewSelect-container").each(function(s,i){e(i).attr("id")!=t.treeContainer.attr("id")&&e(i).addClass("hide")}),t.treeContainer.hasClass("hide")&&t.initialized?(t.treeContainer.removeClass("hide"),t.searchInput.val(""),t.tree.treeview("clearSearch"),t.element.find(".treeviewselect-item").each(function(i,n){var o,r=e(n).attr("nodeid");if(r){if(o=t.getNodeById(r),t.setNodeState(o,!0),o.nodes)t.tree.treeview("expandNode",[o,{levels:1,silent:!0}]);else{var a=t.tree.treeview("getParent",o);a.nodeId&&t.tree.treeview("expandNode",[a,{levels:1,silent:!0}])}0===i&&(s=r)}}),t.goToFirstNodePosition(s)):t.treeContainer.addClass("hide"),!1}),e("html").on("click",function(t){var s=e(t.target);s.hasClass("list-group-item")||s.hasClass("check-icon")||s.hasClass("treeview-search-input")||s.hasClass("expand-icon")||s.hasClass("treeviewSelect-container")||e(".treeviewSelect-container").addClass("hide")})},a.prototype.renderItems=function(t){var s,i,n,a,l,d,h,c,p,u=this,f="";if(t&&this.defaultVals&&this.defaultVals.length>0&&this.defaultVals&&this.defaultVals.length>0)for(var g=0;g<this.defaultVals.length;g++)l=u.getNodeById(this.defaultVals[g]),u.settings.bootstrapTreeParams.multiSelect?u.tree.treeview("checkNode",[l,{silent:!0}]):u.tree.treeview("selectNode",[l,{silent:!0}]);if(u.settings.bootstrapTreeParams.multiSelect?(s=u.tree.treeview("getChecked"),i=s,(u.settings.enableUpCascade||u.settings.enableDownCascade)&&(i=r(u.tree,s))):i=u.tree.treeview("getSelected"),h=e(u.template.clearItem),p=e(u.template.ellipsisItem),d=u.element.find(".treeviewselect-listGroup ul"),d.empty(),u.element.find(".treeviewselect-listOpGroup .treeviewselect-clear").remove(),i&&i.length>0){u.placeholder.hide();for(var g=0;g<i.length;g++)n=0,a=[],o(u.tree,i[g],a),i[g].level=a.length+1,c=u.genTreeSelectItem(i[g]),u.settings.bootstrapTreeParams.multiSelect?(c.css("visibility","hidden"),d.append(c),d.width()-d.position().left>e(".treeviewselect-listOpGroup").position().left-38?(c.hide(),f+=i[g].text+";"):c.css("visibility","visible")):d.append(c);f&&(p.css("visibility","visible").attr({"data-toggle":"tooltip","data-placement":"top",title:f}),d.append(p))}else u.placeholder.show();u.settings.bootstrapTreeParams.multiSelect&&i.length&&(h.find(".glyphicon-remove").on("click",function(){d.empty(),u.placeholder.show(),u.element.find(".treeviewselect-listOpGroup .treeviewselect-clear").remove(),u.tree.treeview("uncheckAll",{silent:!0})}),u.element.find(".treeviewselect-listOpGroup ul").prepend(h)),e('[data-toggle="tooltip"]').tooltip("destroy"),e('[data-toggle="tooltip"]').tooltip(),t||u.element.trigger("completed",[i])},a.prototype.setNodeState=function(e,t,s){this.settings.bootstrapTreeParams.multiSelect?t?this.tree.treeview("checkNode",[e,{silent:!1}]):this.tree.treeview("uncheckNode",[e,{silent:!1}]):this.tree.treeview("selectNode",[e,{silent:!1}])},a.prototype.genTreeSelectItem=function(t){var s,i=this,n=[];if(s=e(i.settings.bootstrapTreeParams.multiSelect?i.template.item:i.template.singleItem),s.attr("nodeid",t.id),i.settings.cascadeText&&!i.settings.bootstrapTreeParams.multiSelect){var r="";if(o(i.tree,t,n),n){for(var a=n.length-1;a>=0;a--)r+=n[a].text+i.settings.cascadeTextSeparator;s.find("span").html(r+t.text)}else s.find("span").html(t.text)}else s.find("span").html(t.text);return t.text.length>3&&s.attr({"data-toggle":"tooltip","data-placement":"top",title:t.text}),s.find(".glyphicon-remove").on("click",function(){var t=e(this),s=i.getNodeById(t.parent().attr("nodeid"));return i.setNodeState(s,!1),0===e(".treeviewselect-listGroup .selected-item").length&&e(".treeviewselect-listOpGroup .treeviewselect-clear").remove(),t.parent().remove(),!1}),s},a.prototype.setTreePosition=function(){var e=this,t=e.element.position(),s=e.element.css("padding-top").replace("px",""),i=e.element.css("padding-bottom").replace("px",""),n=e.element.css("padding-left").replace("px",""),o=e.element.css("padding-right").replace("px",""),r=250,a=e.element.width()+parseInt(n)+parseInt(o),l=t.top+e.element.height()+parseInt(s)+parseInt(i),d=t.left;r=40*e.treeContainer.find("li.list-group-item").length*.2,r=r<250?250:r,e.treeContainer.css({top:l,left:d}),e.tree.css({height:r,width:a}),e.element.css("width",a)},a.prototype.searchNodes=function(e){var t={ignoreCase:!0,exactMatch:!1,revealResults:!0},s=this.tree.treeview("search",[e,t]);return s},a.prototype.getChecked=function(){var t,s=this,i=new Array;if(s.settings.bootstrapTreeParams.multiSelect){if(t=s.tree.treeview("getChecked"))for(var n=0;n<t.length;n++)i.push(t[n].id)}else s.element.find(".treeviewselect-item").each(function(t,s){e(s).hasClass("ellipsis-item")||i.push(e(s).attr("nodeid"))});return i},a.prototype.setDefaults=function(e){e&&e.length&&(this.defaultVals=e,this.renderItems(!0))},a.prototype.getNodeById=function(e){var t,s=this,i=s.tree.treeview("getAllNodes");if(i&&i.length>0)for(var n=i.length-1;n>=0&&(t=i[n],t.id!=e);n--);return t},a.prototype.goToFirstNodePosition=function(e){var t,s,i,n=this,o=n.getNodeById(e);o&&(t=n.tree.find("li[data-nodeid="+o.nodeId+"]"),t.length>0?(s=t.prevAll(),i=t.height()+parseInt(t.css("padding-top").replace("px",""))+parseInt(t.css("padding-bottom").replace("px","")),n.tree.scrollTop(i*s.length-60)):n.tree.scrollTop(0))},a.prototype.template={listGroup:'<li class="treeviewselect-listGroup"><ul></ul></li>',listOpGroup:'<li class="treeviewselect-listOpGroup"><ul></ul></li>',item:'<li class="treeviewselect-item selected-item"><i class="glyphicon glyphicon-remove"></i><span></span></li>',clearItem:'<li class="treeviewselect-clear"><i class="glyphicon glyphicon-remove"></i></li>',ellipsisItem:'<li class="treeviewselect-item ellipsis-item">....</li>',singleItem:'<li class="treeviewselect-item"><span></span></li>',bottomArrowItem:'<li class="treeviewselect-arrow"><i class="glyphicon glyphicon-triangle-bottom"></i></li>',inlineInput:'<li><input type="text" class="treeviewSelect-inline-input"></li>',treeContainer:'<ul class="treeviewSelect-container hide"></ul>',searchInput:'<input class="treeview-search-input" placeholder="请搜索..."></input>',tree:'<div class="treeviewSelect-tree"></div>',placeholder:'<li class="treeviewselect-placeholder"></li>'};var h=function(e){t.console&&t.console.error(e)};e.fn[l]=function(t,s){var i;return this.each(function(){var n=e.data(this,l);"string"==typeof t?n?e.isFunction(n[t])&&"_"!==t.charAt(0)?i=n[t].apply(n,s):h("No such method : "+t):h("Not initialized, can not call method : "+t):"object"==typeof t&&(n?n.init.call(n,t):e.data(this,l,new a(this,e.extend(!0,{},t))))}),i||this}}(jQuery,window,document);